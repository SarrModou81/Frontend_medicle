<!-- src/app/components/medecin/medecin-profil/medecin-profil.component.html -->
<div class="medecin-profil-container">
  <div class="page-header">
    <h1>Mon profil médecin</h1>
    <p>Gérez vos informations professionnelles</p>
  </div>

  <!-- Chargement -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Chargement de votre profil...</p>
  </div>

  <div *ngIf="!isLoading" class="profil-content">
    
    <!-- Statut de disponibilité -->
    <mat-card class="disponibilite-card">
      <mat-card-header>
        <mat-card-title>Statut de disponibilité</mat-card-title>
        <mat-card-subtitle>Gérez votre disponibilité pour recevoir de nouveaux patients</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <form [formGroup]="disponibiliteForm" (ngSubmit)="onSubmitDisponibilite()">
          <mat-slide-toggle formControlName="disponible" color="primary">
            {{ disponibiliteForm.get('disponible')?.value ? 'Disponible pour de nouveaux rendez-vous' : 'Non disponible' }}
          </mat-slide-toggle>
          <div class="disponibilite-actions">
            <button mat-raised-button color="primary" type="submit">
              Mettre à jour
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>

    <!-- Informations professionnelles -->
    <mat-card class="profil-card">
      <mat-card-header>
        <mat-card-title>Informations professionnelles</mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <form [formGroup]="profilForm" (ngSubmit)="onSubmitProfil()">
          
          <!-- Informations de base (non modifiables) -->
          <div class="section">
            <h3>Informations personnelles</h3>
            <div class="form-row">
              <mat-form-field appearance="outline" class="half-width">
                <mat-label>Nom</mat-label>
                <input matInput formControlName="nom">
              </mat-form-field>

              <mat-form-field appearance="outline" class="half-width">
                <mat-label>Prénom</mat-label>
                <input matInput formControlName="prenom">
              </mat-form-field>
            </div>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Email</mat-label>
              <input matInput formControlName="email">
              <mat-icon matSuffix>email</mat-icon>
            </mat-form-field>

            <div class="form-row">
              <mat-form-field appearance="outline" class="half-width">
                <mat-label>Téléphone</mat-label>
                <input matInput formControlName="telephone" placeholder="+221 77 XXX XX XX">
                <mat-icon matSuffix>phone</mat-icon>
                <mat-error>{{ getErrorMessage('telephone') }}</mat-error>
              </mat-form-field>

              <div class="specialite-display half-width">
                <label>Spécialité</label>
                <div class="specialite-value">{{ getSpecialiteNom() }}</div>
              </div>
            </div>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Adresse personnelle</mat-label>
              <textarea matInput formControlName="adresse" rows="2"></textarea>
              <mat-icon matSuffix>location_on</mat-icon>
            </mat-form-field>
          </div>

          <!-- Informations professionnelles -->
          <div class="section">
            <h3>Expérience et formation</h3>
            
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Années d'expérience</mat-label>
              <input matInput type="number" formControlName="experience_annees" min="0" max="50">
              <mat-hint>Nombre d'années d'expérience en médecine</mat-hint>
              <mat-error>{{ getErrorMessage('experience_annees') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Diplômes et formations</mat-label>
              <textarea matInput formControlName="diplomes" rows="3" maxlength="1000"
                        placeholder="Listez vos diplômes, certifications et formations..."></textarea>
              <mat-hint align="end">{{ profilForm.get('diplomes')?.value?.length || 0 }}/1000</mat-hint>
              <mat-error>{{ getErrorMessage('diplomes') }}</mat-error>
            </mat-form-field>
          </div>

          <!-- Présentation -->
          <div class="section">
            <h3>Présentation</h3>
            
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Votre présentation</mat-label>
              <textarea matInput formControlName="presentation" rows="4" maxlength="1000"
                        placeholder="Présentez-vous à vos futurs patients..."></textarea>
              <mat-hint align="end">{{ profilForm.get('presentation')?.value?.length || 0 }}/1000</mat-hint>
              <mat-error>{{ getErrorMessage('presentation') }}</mat-error>
            </mat-form-field>
          </div>

          <!-- Informations cabinet -->
          <div class="section">
            <h3>Cabinet médical</h3>
            
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Nom du cabinet</mat-label>
              <input matInput formControlName="cabinet_nom" placeholder="Ex: Cabinet Médical de la Paix">
              <mat-icon matSuffix>business</mat-icon>
              <mat-error>{{ getErrorMessage('cabinet_nom') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Adresse du cabinet</mat-label>
              <textarea matInput formControlName="cabinet_adresse" rows="2"
                        placeholder="Adresse complète de votre cabinet..."></textarea>
              <mat-icon matSuffix>location_on</mat-icon>
              <mat-error>{{ getErrorMessage('cabinet_adresse') }}</mat-error>
            </mat-form-field>
          </div>

          <!-- Tarifs et consultations -->
          <div class="section">
            <h3>Consultations et tarifs</h3>
            
            <div class="form-row">
              <mat-form-field appearance="outline" class="half-width">
                <mat-label>Prix de consultation (FCFA)</mat-label>
                <input matInput type="number" formControlName="prix_consultation" min="0" max="1000000">
                <mat-icon matSuffix>attach_money</mat-icon>
                <mat-error>{{ getErrorMessage('prix_consultation') }}</mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="half-width">
                <mat-label>Durée consultation (minutes)</mat-label>
                <input matInput type="number" formControlName="duree_consultation" min="15" max="120">
                <mat-icon matSuffix>schedule</mat-icon>
                <mat-error>{{ getErrorMessage('duree_consultation') }}</mat-error>
              </mat-form-field>
            </div>

            <div class="checkbox-section">
              <mat-checkbox formControlName="accepte_paiement_ligne">
                J'accepte les paiements en ligne
              </mat-checkbox>
              <small>Les patients pourront payer leurs consultations par carte bancaire</small>
            </div>
          </div>

        </form>
      </mat-card-content>

      <mat-card-actions class="form-actions">
        <button mat-raised-button 
                color="primary" 
                type="submit"
                [disabled]="!profilForm.valid || isSaving"
                (click)="onSubmitProfil()">
          <mat-icon *ngIf="isSaving" class="spinner">refresh</mat-icon>
          {{ isSaving ? 'Sauvegarde...' : 'Sauvegarder les modifications' }}
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>